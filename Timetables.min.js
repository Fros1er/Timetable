!function(e){var t=function(e){this.el=document.querySelector(e.el),this.Timetables=e.timetables||[],this.week=e.week||[],this.merge="boolean"!=typeof e.merge||e.merge,this.TimetableType=e.timetableType||[],this.leftHandText=[],this.highlightWeek=e.highlightWeek||"",this.gridOnClick="function"==typeof e.gridOnClick?e.gridOnClick:void 0;var t=e.styles||{};this.leftHandWidth=t.leftHandWidth||40,this.Gheight=t.Gheight||48,this.defaultPalette=["#f05261","#48a8e4","#ffd061","#52db9a","#70d3e6","#52db9a","#3f51b5","#f3d147","#4adbc3","#673ab7","#f3db49","#76bfcd","#b495e1","#ff9800","#8bc34a"],this.palette=("boolean"!=typeof t.palette||!!t.palett)&&(t.palette||[]).concat(this.defaultPalette),this._init()};t.prototype={_init:function(e){var t,e=e||{},i=e.styles||{},n=e.gridOnClick||this.gridOnClick,l="boolean"==typeof e.merge?e.merge:this.merge,a=e.highlightWeek||this.highlightWeek,s=this.leftHandText,h=i.leftHandWidth||this.leftHandWidth,o=i.Gheight||this.Gheight;if(t=("boolean"!=typeof i.palette||!!i.palette)&&(i.palette?(i.palette||[]).concat(this.defaultPalette):this.palette),!l){console.error("None-merge mode is not implemented.");return}var r=e.timetables||this.Timetables,d=e.week||this.week,f=JSON.parse(JSON.stringify(e.timetableType||this.TimetableType)),p=e.timetableType||this.TimetableType,c=f.length;r.forEach(function(e,t){if(e.length<c)for(var i=0;i<c-e.length;i++)e.push("")}),e.setNewOption&&this.el.removeChild(this.el.childNodes[0]);var g=document.createElement("div");g.id="courseWrapper",g.style.position="relative",g.style.paddingLeft=h+"px",g.style.border="1px solid #dbdbdb",f.forEach(function(e,t){e.unshift(t+1)});var m=document.createElement("div");m.className="Courses-leftHand",m.style.position="absolute",m.style.left=0,m.style.top=0,m.style.width=h+"px";var y=r[0].map(function(e,t){return[]});y.forEach(function(e,t){r.forEach(function(e,i){y[t].push(e[t])})});var u=[];l&&r.forEach(function(e,t){u[t]||(u[t]=[]),e.forEach(function(e,i){if(!i||JSON.stringify(e)!==JSON.stringify((u[t][i-1]||{}).name)||!e)return u[t].push({name:e,length:1});var n=(u[t][i-1]||{}).sameIndex;return n||0===n?(u[t][n].length++,u[t].push({name:e,length:0,sameIndex:n})):(u[t][i-1].length++,u[t].push({name:e,length:0,sameIndex:i-1}))})});var b=document.createElement("div");b.style.overflow="hidden",b.className="Courses-head",d.forEach(function(e,t){var i=document.createElement("div");i.className=(a===t+1?"highlight-week ":"")+"Courses-head-"+(t+1),i.innerText=e,i.style.cssFloat="left",i.style.boxSizing="border-box",i.style.whiteSpace="nowrap",i.style.width=100/d.length+"%",b.appendChild(i)}),g.appendChild(b);var $=document.createElement("div");$.className="Courses-content";var v=0;y.forEach(function(e,i){var a=document.createElement("ul");a.style.listStyle="none",a.style.padding="0px",a.style.margin="0px",a.style.minHeight=o+"px",a.className="stage_"+((f[0]||[])[0]||"none"),--(f[0]||[])[2],(f[0]||[])[2]||f.shift(),e.forEach(function(e,s){if(!(s>d.length-1)){var h=document.createElement("li");if(h.style.cssFloat="left",h.style.width=100/d.length+"%",h.style.height=o+"px",h.style.boxSizing="border-box",h.style.position="relative",l){if(u[s][i].length>=1){"string"==typeof u[s][i].name&&(""==u[s][i].name?u[s][i].name=[]:u[s][i].name=[u[s][i].name]);let r=100/u[s][i].name.length;for(let f=0;f<u[s][i].name.length;f++){var p=document.createElement("span");p.style.position="absolute",p.style.zIndex=9,p.style.width=r+"%",p.style.height=o*u[s][i].length+"px",p.style.left=r*f+"%",p.style.top=0,t&&(p.style.backgroundColor=t[v],p.style.color="#fff",++v>=t.length&&(v=0)),p.innerText=u[s][i].name[f],p.className="course-hasContent",p.onclick=function(){n&&n(u[s][i].name[f])},h.appendChild(p)}}else 0===u[s][i].length&&(h.innerText="")}a.appendChild(h)}}),$.appendChild(a)}),g.appendChild($),g.appendChild(m),this.el.appendChild(g);var x=(document.querySelector(".stage_1 li")||document.querySelector(".stage_none li")).offsetHeight,C=document.querySelector(".Courses-head").offsetHeight,E=document.createElement("div");E.className="left-hand-TextDom",E.style.height=C+"px",E.style.boxSizing="border-box",s.forEach(function(e){var t=document.createElement("div");t.innerText=e,E.appendChild(t)}),m.appendChild(E),p.forEach(function(e,t){var i=document.createElement("div");if(i.style.width="100%",i.style.height=x*e[1]+"px",i.style.boxSizing="border-box","object"==typeof e[0])for(var n in e[0]){var l=document.createElement("p");l.innerText=e[0][n],l.style.margin="0px",l.className="left-hand-"+n,i.appendChild(l)}else i.innerText=e[0]||"";i.className="left-hand-"+(t+1),m.appendChild(i)})},setOption:function(e){(e||{}).setNewOption=!0,this._init(e)}},"undefined"!=typeof module&&module.exports&&(module.exports=t),"function"==typeof define&&define(function(){return t}),e.Timetables=t}(this);